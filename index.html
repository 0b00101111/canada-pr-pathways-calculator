<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canada PR Pathways Calculator - Your Guide to Canadian Immigration</title>
    <meta name="description" content="Understand Canadian immigration, calculate your Express Entry CRS score, and discover your pathway to permanent residence. Free, private, and educational.">
    <meta name="keywords" content="Canada PR, Express Entry, CRS calculator, immigration to Canada, permanent residence, PNP, PGWP, French draws">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            line-height: 1.6;
            color: #2d3748;
            background: #f8f9fa;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
            color: white;
            padding: 60px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: 'üçÅ';
            position: absolute;
            font-size: 200px;
            opacity: 0.1;
            top: -50px;
            right: -50px;
            transform: rotate(-15deg);
        }
        
        .header h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
            position: relative;
        }
        
        .header p {
            font-size: 1.3em;
            max-width: 800px;
            margin: 0 auto;
            opacity: 0.95;
            position: relative;
        }
        
        /* Navigation */
        .nav-tabs {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            overflow-x: auto;
        }
        
        .nav-tab {
            padding: 20px 30px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            color: #718096;
            transition: all 0.3s;
            white-space: nowrap;
        }
        
        .nav-tab:hover {
            color: #2d3748;
            background: #f7fafc;
        }
        
        .nav-tab.active {
            color: #e53e3e;
            border-bottom-color: #e53e3e;
        }
        
        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Content Sections */
        .content-section {
            display: none;
            animation: fadeIn 0.5s;
        }
        
        .content-section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Learn Section */
        .intro-hero {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .intro-hero h2 {
            font-size: 2em;
            color: #2d3748;
            margin-bottom: 20px;
        }
        
        .intro-hero p {
            font-size: 1.1em;
            color: #4a5568;
            line-height: 1.8;
            margin-bottom: 15px;
        }
        
        .term-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }
        
        .term-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.08);
            transition: all 0.3s;
            border-left: 4px solid #e53e3e;
        }
        
        .term-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        .term-card h3 {
            color: #2d3748;
            font-size: 1.4em;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .term-card .acronym {
            font-size: 0.8em;
            color: #718096;
            font-weight: normal;
        }
        
        .term-card p {
            color: #4a5568;
            line-height: 1.7;
            margin: 10px 0;
        }
        
        .term-card .example {
            background: #f7fafc;
            padding: 12px;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 0.95em;
            color: #2d3748;
            border-left: 3px solid #4299e1;
        }
        
        .pathways-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }
        
        .pathway-card {
            background: linear-gradient(135deg, #ffffff 0%, #f7fafc 100%);
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .pathway-card:hover {
            border-color: #e53e3e;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(229, 62, 62, 0.15);
        }
        
        .pathway-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
        }
        
        .pathway-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 10px;
        }
        
        .pathway-description {
            color: #718096;
            font-size: 0.95em;
            margin-bottom: 15px;
        }
        
        .pathway-requirements {
            background: white;
            padding: 10px;
            border-radius: 8px;
            font-size: 0.85em;
        }
        
        .pathway-requirements strong {
            color: #2d3748;
            display: block;
            margin-bottom: 5px;
        }
        
        .faq-section {
            margin: 40px 0;
        }
        
        .faq-item {
            background: white;
            border-radius: 12px;
            margin-bottom: 15px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .faq-question {
            padding: 20px 25px;
            font-weight: 600;
            color: #2d3748;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s;
        }
        
        .faq-question:hover {
            background: #f7fafc;
        }
        
        .faq-question::after {
            content: '+';
            font-size: 1.5em;
            color: #e53e3e;
            transition: transform 0.3s;
        }
        
        .faq-item.open .faq-question::after {
            transform: rotate(45deg);
        }
        
        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s;
        }
        
        .faq-item.open .faq-answer {
            max-height: 500px;
        }
        
        .faq-answer-content {
            padding: 0 25px 20px;
            color: #4a5568;
            line-height: 1.7;
        }
        
        /* Calculator Section */
        .calculator-intro {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 40px;
        }
        
        .calculator-intro h2 {
            font-size: 2em;
            margin-bottom: 15px;
        }
        
        .calculator-intro p {
            font-size: 1.1em;
            opacity: 0.95;
            max-width: 700px;
            margin: 0 auto 25px;
        }
        
        .start-calculator-btn {
            background: white;
            color: #667eea;
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .start-calculator-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .journey-selection {
            display: none;
            margin: 40px 0;
        }
        
        .journey-selection.active {
            display: block;
        }
        
        .journey-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
        }
        
        .journey-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid transparent;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .journey-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }
        
        .journey-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #f6f8fb 0%, #ffffff 100%);
        }
        
        .journey-icon {
            font-size: 3em;
            margin-bottom: 20px;
        }
        
        .journey-title {
            font-size: 1.4em;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 15px;
        }
        
        .journey-description {
            color: #718096;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        
        .journey-examples {
            background: #f7fafc;
            padding: 15px;
            border-radius: 10px;
            font-size: 0.9em;
            color: #4a5568;
        }
        
        /* Calculator Form */
        .calculator-form {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        
        .calculator-form.active {
            display: block;
        }
        
        /* Resources Section */
        .resource-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }
        
        .resource-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.08);
            transition: all 0.3s;
        }
        
        .resource-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .resource-card h3 {
            color: #2d3748;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .resource-card .icon {
            font-size: 1.5em;
        }
        
        .resource-card a {
            color: #e53e3e;
            text-decoration: none;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-top: 10px;
        }
        
        .resource-card a:hover {
            text-decoration: underline;
        }
        
        /* Info boxes */
        .info-box {
            background: #edf2f7;
            border-left: 4px solid #4299e1;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        .info-box.warning {
            background: #fef5e7;
            border-left-color: #f6ad55;
        }
        
        .info-box.success {
            background: #f0fff4;
            border-left-color: #48bb78;
        }
        
        .info-box h4 {
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .info-box p {
            color: #4a5568;
            line-height: 1.6;
        }
        
        /* Footer */
        .footer {
            background: #2d3748;
            color: white;
            padding: 40px 20px;
            text-align: center;
            margin-top: 60px;
        }
        
        .footer p {
            opacity: 0.8;
            margin-bottom: 10px;
        }
        
        .footer a {
            color: #4299e1;
            text-decoration: none;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .nav-container {
                overflow-x: auto;
            }
            
            .term-cards {
                grid-template-columns: 1fr;
            }
            
            .pathways-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>üçÅ Canada PR Pathways Calculator</h1>
        <p>Understand Canadian immigration, calculate your score, and discover your pathway to permanent residence</p>
    </div>
    
    <!-- Navigation -->
    <div class="nav-tabs">
        <div class="nav-container">
            <button class="nav-tab active" onclick="switchSection('learn', this)">üìö Learn</button>
            <button class="nav-tab" onclick="switchSection('pathways', this)">üó∫Ô∏è Pathways</button>
            <button class="nav-tab" onclick="switchSection('calculator', this)">üßÆ Calculator</button>
            <button class="nav-tab" onclick="switchSection('resources', this)">üìñ Resources</button>
        </div>
    </div>
    
    <div class="container">
        <!-- Learn Section -->
        <section class="content-section active" id="learnSection">
            <div class="intro-hero">
                <h2>Welcome to Your Canadian Immigration Journey!</h2>
                <p>If you're confused by terms like "Express Entry," "CRS," or "PNP," you're not alone. Even people who've been in Canada for years find the immigration system overwhelming.</p>
                <p>Let's break it down in simple terms. Think of immigrating to Canada like applying to university - there's an application system (Express Entry), a scoring method (CRS), and different programs you can qualify for. Some paths are harder, some easier, but understanding the system is half the battle.</p>
            </div>
            
            <h2 style="margin: 40px 0 30px; color: #2d3748; font-size: 1.8em;">Key Terms You Need to Know</h2>
            
            <div class="term-cards">
                <div class="term-card">
                    <h3>Express Entry <span class="acronym">(EE)</span></h3>
                    <p><strong>What it is:</strong> Canada's online system for managing immigration applications. Think of it as a dating app, but for immigration - you create a profile, get scored, and Canada invites the highest scores.</p>
                    <p><strong>Why it matters:</strong> It's the main pathway for skilled workers to get PR. Processing takes only 6 months!</p>
                    <div class="example">
                        <strong>Example:</strong> You submit your profile in January, get invited in March, and could have PR by September.
                    </div>
                </div>
                
                <div class="term-card">
                    <h3>CRS Score <span class="acronym">(Comprehensive Ranking System)</span></h3>
                    <p><strong>What it is:</strong> Your immigration "credit score" out of 1,200 points. Based on age, education, language skills, and work experience.</p>
                    <p><strong>Why it matters:</strong> Canada invites people with the highest scores. If the cutoff is 480 and you have 481, you're in!</p>
                    <div class="example">
                        <strong>Current reality:</strong> General draws need 480-530 points. French speakers can get invited with 350-430 points.
                    </div>
                </div>
                
                <div class="term-card">
                    <h3>French Language Draws</h3>
                    <p><strong>What it is:</strong> Special invitation rounds just for French speakers (CLB 7+). Much lower score requirements!</p>
                    <p><strong>Why it matters:</strong> It's like having a VIP fast-pass. While others need 500+ points, French speakers get invited with 350-430.</p>
                    <div class="example">
                        <strong>Real example:</strong> March 2025 French draw: 379 points. Same week general draw: 524 points. That's a 145-point advantage!
                    </div>
                </div>
                
                <div class="term-card">
                    <h3>Provincial Nominee <span class="acronym">(PNP)</span></h3>
                    <p><strong>What it is:</strong> Individual provinces can "nominate" you if they want you specifically. Worth 600 bonus points!</p>
                    <p><strong>Why it matters:</strong> It's a guaranteed invitation. Even with a low base score of 300, a nomination puts you at 900 points.</p>
                    <div class="example">
                        <strong>Popular PNPs:</strong> Ontario Tech draws, BC Tech, Alberta Accelerated Tech, Saskatchewan In-Demand Occupations.
                    </div>
                </div>
                
                <div class="term-card">
                    <h3>PGWP <span class="acronym">(Post-Graduation Work Permit)</span></h3>
                    <p><strong>What it is:</strong> After studying in Canada, you get an open work permit for 1-3 years (depending on program length).</p>
                    <p><strong>Why it matters:</strong> It's your bridge to PR. Study ‚Üí PGWP ‚Üí Work Experience ‚Üí PR.</p>
                    <div class="example">
                        <strong>Your timeline:</strong> 2-year Master's = 3-year PGWP. Work 1 year = eligible for Canadian Experience Class.
                    </div>
                </div>
                
                <div class="term-card">
                    <h3>CLB Levels <span class="acronym">(Canadian Language Benchmark)</span></h3>
                    <p><strong>What it is:</strong> Canada's way of measuring English/French ability, from 1-10.</p>
                    <p><strong>Key levels:</strong><br>
                    ‚Ä¢ CLB 7 = Professional working level (IELTS 6.0 all bands)<br>
                    ‚Ä¢ CLB 9 = Near-native (IELTS 7+ in most bands)<br>
                    ‚Ä¢ CLB 5 = Basic communication</p>
                    <div class="example">
                        <strong>Pro tip:</strong> Jumping from CLB 7 to CLB 9 can add 50+ points to your score!
                    </div>
                </div>
            </div>
            
            <div class="info-box">
                <h4>üí° The Big Picture</h4>
                <p>Canadian immigration is actually quite logical once you understand it. Canada wants young, educated, bilingual professionals with Canadian experience. The more of these boxes you tick, the higher your score. The calculator will show you exactly which improvements give you the most points for your effort.</p>
            </div>
            
            <div class="faq-section">
                <h2 style="margin: 40px 0 30px; color: #2d3748; font-size: 1.8em;">Common Questions</h2>
                
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        Do I need a job offer to immigrate to Canada?
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            No! This is the biggest misconception. Most people get PR without a job offer. As of March 2025, job offers don't even give you extra points anymore. Focus on education, language skills, and Canadian experience instead.
                        </div>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        I'm studying in Canada. What's my best path to PR?
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            Your path is actually quite clear: Complete your degree ‚Üí Get PGWP ‚Üí Work for 1 year in a skilled job ‚Üí Apply through Canadian Experience Class. If you learn French to CLB 7, you could potentially apply even before getting work experience!
                        </div>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        Is learning French really worth it for immigration?
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            Absolutely! French CLB 7 + English CLB 5 = 50 bonus points. Plus, French-only draws have MUCH lower requirements (often 350-430 vs 480-530). It's probably the single best investment of time for immigration. 12-18 months of French study could save you years of waiting.
                        </div>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        How accurate are CRS calculators?
                    </div>
                    <div class="faq-answer">
                        <div class="faq-answer-content">
                            Very accurate if you input correct information. The scoring system is public and transparent. Our calculator uses the exact same formulas as IRCC. The only variable is future draw scores, which depend on how many people apply and how many invitations Canada issues.
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Pathways Section -->
        <section class="content-section" id="pathwaysSection">
            <h2 style="margin: 30px 0; color: #2d3748; font-size: 2em;">Common Pathways to Canadian PR</h2>
            
            <div class="pathways-grid">
                <div class="pathway-card">
                    <div class="pathway-icon">üéì</div>
                    <div class="pathway-title">Study ‚Üí Work ‚Üí PR</div>
                    <div class="pathway-description">
                        The most predictable path. Study in Canada, get work experience, apply for PR.
                    </div>
                    <div class="pathway-requirements">
                        <strong>Timeline:</strong> 3-4 years total<br>
                        <strong>Steps:</strong><br>
                        1. Complete Canadian degree (1-4 years)<br>
                        2. Get PGWP (automatic)<br>
                        3. Work 1 year<br>
                        4. Apply via Express Entry<br>
                        <strong>Success rate:</strong> Very high
                    </div>
                </div>
                
                <div class="pathway-card">
                    <div class="pathway-icon">üá´üá∑</div>
                    <div class="pathway-title">French Language Fast Track</div>
                    <div class="pathway-description">
                        Learn French, get invited with much lower scores. Works from anywhere!
                    </div>
                    <div class="pathway-requirements">
                        <strong>Timeline:</strong> 12-18 months<br>
                        <strong>Requirements:</strong><br>
                        ‚Ä¢ French CLB 7 (all skills)<br>
                        ‚Ä¢ English CLB 5+<br>
                        ‚Ä¢ Basic education & experience<br>
                        <strong>Recent scores:</strong> 350-430 points
                    </div>
                </div>
                
                <div class="pathway-card">
                    <div class="pathway-icon">üíº</div>
                    <div class="pathway-title">Direct Express Entry</div>
                    <div class="pathway-description">
                        Apply directly from your home country with strong profile.
                    </div>
                    <div class="pathway-requirements">
                        <strong>Timeline:</strong> 6-8 months<br>
                        <strong>Need:</strong><br>
                        ‚Ä¢ Master's degree<br>
                        ‚Ä¢ 3+ years experience<br>
                        ‚Ä¢ IELTS 8777 or higher<br>
                        ‚Ä¢ Age under 30<br>
                        <strong>Typical score:</strong> 470-490
                    </div>
                </div>
                
                <div class="pathway-card">
                    <div class="pathway-icon">üèõÔ∏è</div>
                    <div class="pathway-title">Provincial Nominee</div>
                    <div class="pathway-description">
                        Get nominated by a province for 600 bonus points.
                    </div>
                    <div class="pathway-requirements">
                        <strong>Timeline:</strong> 8-12 months<br>
                        <strong>Popular streams:</strong><br>
                        ‚Ä¢ Tech workers (BC, Ontario)<br>
                        ‚Ä¢ Healthcare (all provinces)<br>
                        ‚Ä¢ Trades (Alberta, Saskatchewan)<br>
                        <strong>Base score needed:</strong> 300-400
                    </div>
                </div>
                
                <div class="pathway-card">
                    <div class="pathway-icon">üë®‚Äçüë©‚Äçüëß</div>
                    <div class="pathway-title">Family Sponsorship</div>
                    <div class="pathway-description">
                        If you have Canadian family members (spouse, parents, siblings).
                    </div>
                    <div class="pathway-requirements">
                        <strong>Timeline:</strong> 12 months<br>
                        <strong>Who can sponsor:</strong><br>
                        ‚Ä¢ Spouse/partner<br>
                        ‚Ä¢ Parents (if you're under 22)<br>
                        ‚Ä¢ Note: Siblings can't sponsor,<br>
                        but give you 15 CRS points
                    </div>
                </div>
                
                <div class="pathway-card">
                    <div class="pathway-icon">üöÄ</div>
                    <div class="pathway-title">Start-up Visa</div>
                    <div class="pathway-description">
                        For entrepreneurs with innovative business ideas.
                    </div>
                    <div class="pathway-requirements">
                        <strong>Timeline:</strong> 12-18 months<br>
                        <strong>Requirements:</strong><br>
                        ‚Ä¢ Support from designated org<br>
                        ‚Ä¢ Innovative business idea<br>
                        ‚Ä¢ CLB 5 minimum<br>
                        ‚Ä¢ Settlement funds<br>
                        <strong>Success factor:</strong> Quality of idea
                    </div>
                </div>
            </div>
            
            <div class="info-box success">
                <h4>üéØ Which Path Is Best For You?</h4>
                <p><strong>If you're young (under 30):</strong> Consider studying in Canada. The experience is valuable and PR is almost guaranteed.<br><br>
                <strong>If you're older (30+):</strong> Focus on French! Age reduces your points, but French can more than compensate.<br><br>
                <strong>If you have tech skills:</strong> Look at Provincial Nominee Programs. BC and Ontario actively recruit tech workers.<br><br>
                <strong>If you're already in Canada:</strong> Focus on getting skilled work experience. Even 1 year makes a huge difference.</p>
            </div>
        </section>
        
        <!-- Calculator Section -->
        <section class="content-section" id="calculatorSection">
            <div class="calculator-intro">
                <h2>Ready to Calculate Your Score?</h2>
                <p>Our calculator doesn't just give you a number - it shows you multiple scenarios and timelines, helping you understand which improvements give the best return on investment.</p>
                <button class="start-calculator-btn" onclick="startCalculator()">Start Calculator ‚Üí</button>
            </div>
            
            <!-- Journey Selection (Initially Hidden) -->
            <div class="journey-selection" id="journeySelection">
                <h3 style="text-align: center; margin-bottom: 30px; color: #2d3748;">First, which best describes your situation?</h3>
                <div class="journey-cards">
                    <div class="journey-card" onclick="selectJourney('dreaming')">
                        <div class="journey-icon">üí≠</div>
                        <div class="journey-title">I'm Planning My Journey</div>
                        <div class="journey-description">
                            I'm outside Canada, exploring my options and want to understand what's possible
                        </div>
                        <div class="journey-examples">
                            <strong>Perfect if you:</strong><br>
                            ‚Ä¢ Are working in your home country<br>
                            ‚Ä¢ Haven't taken language tests yet<br>
                            ‚Ä¢ Want to see different pathways
                        </div>
                    </div>
                    
                    <div class="journey-card" onclick="selectJourney('studying')">
                        <div class="journey-icon">üéì</div>
                        <div class="journey-title">I'm Studying in Canada</div>
                        <div class="journey-description">
                            Currently a student in Canada, planning for PR after graduation
                        </div>
                        <div class="journey-examples">
                            <strong>Perfect if you:</strong><br>
                            ‚Ä¢ Are in a Canadian college/university<br>
                            ‚Ä¢ Will graduate in 6-24 months<br>
                            ‚Ä¢ Want to optimize your time here
                        </div>
                    </div>
                    
                    <div class="journey-card" onclick="selectJourney('working')">
                        <div class="journey-icon">üíº</div>
                        <div class="journey-title">I'm Working in Canada</div>
                        <div class="journey-description">
                            Already working in Canada on a work permit or PGWP
                        </div>
                        <div class="journey-examples">
                            <strong>Perfect if you:</strong><br>
                            ‚Ä¢ Have a PGWP or work permit<br>
                            ‚Ä¢ Already have Canadian experience<br>
                            ‚Ä¢ Ready to apply soon
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Calculator Form (Hidden until journey selected) -->
            <div class="calculator-form" id="calculatorForm">
                <!-- This would contain the full calculator form from the previous version -->
                <p>Calculator form will appear here after journey selection...</p>
            </div>
        </section>
        
        <!-- Resources Section -->
        <section class="content-section" id="resourcesSection">
            <h2 style="margin: 30px 0; color: #2d3748; font-size: 2em;">Essential Resources</h2>
            
            <div class="resource-grid">
                <div class="resource-card">
                    <h3><span class="icon">üèõÔ∏è</span> Official Government Sites</h3>
                    <p>Always verify information with official sources:</p>
                    <a href="https://www.canada.ca/en/immigration-refugees-citizenship/services/immigrate-canada/express-entry.html" target="_blank">
                        IRCC Express Entry ‚Üí
                    </a><br>
                    <a href="https://www.cic.gc.ca/english/helpcentre/index-featured-can.asp" target="_blank">
                        IRCC Help Centre ‚Üí
                    </a><br>
                    <a href="https://ircc.canada.ca/english/express-entry/rounds.asp" target="_blank">
                        Recent Draw Results ‚Üí
                    </a>
                </div>
                
                <div class="resource-card">
                    <h3><span class="icon">üìù</span> Language Tests</h3>
                    <p>Book your official language tests:</p>
                    <a href="https://www.ieltscanada.ca/" target="_blank">
                        IELTS (English) ‚Üí
                    </a><br>
                    <a href="https://www.celpip.ca/" target="_blank">
                        CELPIP (English) ‚Üí
                    </a><br>
                    <a href="https://www.lefrancaisdesaffaires.fr/en/tests-diplomas/test-for-evaluating-french-tef/tefcanada/" target="_blank">
                        TEF Canada (French) ‚Üí
                    </a><br>
                    <a href="https://www.france-education-international.fr/en/tcf-canada" target="_blank">
                        TCF Canada (French) ‚Üí
                    </a>
                </div>
                
                <div class="resource-card">
                    <h3><span class="icon">üéì</span> Educational Credential Assessment</h3>
                    <p>Get your foreign degrees evaluated:</p>
                    <a href="https://www.wes.org/ca/" target="_blank">
                        WES Canada ‚Üí
                    </a><br>
                    <a href="https://www.iqascanada.ca/" target="_blank">
                        IQAS ‚Üí
                    </a><br>
                    <a href="https://www.ices.on.ca/" target="_blank">
                        ICES ‚Üí
                    </a>
                </div>
                
                <div class="resource-card">
                    <h3><span class="icon">üó∫Ô∏è</span> Provincial Programs</h3>
                    <p>Explore provincial nominee programs:</p>
                    <a href="https://www.ontario.ca/page/ontario-immigrant-nominee-program-oinp" target="_blank">
                        Ontario (OINP) ‚Üí
                    </a><br>
                    <a href="https://www.welcomebc.ca/Immigrate-to-B-C/About-The-BC-PNP" target="_blank">
                        British Columbia (BC PNP) ‚Üí
                    </a><br>
                    <a href="https://www.alberta.ca/alberta-advantage-immigration-program" target="_blank">
                        Alberta (AAIP) ‚Üí
                    </a>
                </div>
                
                <div class="resource-card">
                    <h3><span class="icon">üí¨</span> Community Forums</h3>
                    <p>Connect with others on the same journey:</p>
                    <a href="https://www.canadavisa.com/canada-immigration-discussion-board/" target="_blank">
                        CanadaVisa Forum ‚Üí
                    </a><br>
                    <a href="https://www.reddit.com/r/ImmigrationCanada/" target="_blank">
                        Reddit r/ImmigrationCanada ‚Üí
                    </a><br>
                    <a href="https://moving2canada.com/" target="_blank">
                        Moving2Canada ‚Üí
                    </a>
                </div>
                
                <div class="resource-card">
                    <h3><span class="icon">üìö</span> Learning French</h3>
                    <p>Start your French journey:</p>
                    <a href="https://www.alliance-fran√ßaise.ca/" target="_blank">
                        Alliance Fran√ßaise Canada ‚Üí
                    </a><br>
                    <a href="https://www.duolingo.com/course/fr/en/Learn-French" target="_blank">
                        Duolingo (Free) ‚Üí
                    </a><br>
                    <a href="https://www.babbel.com/french" target="_blank">
                        Babbel ‚Üí
                    </a>
                </div>
            </div>
            
            <div class="info-box warning">
                <h4>‚ö†Ô∏è Important Disclaimers</h4>
                <p>‚Ä¢ This calculator is for educational purposes only and doesn't constitute legal advice<br>
                ‚Ä¢ Immigration rules change frequently - always verify with official IRCC sources<br>
                ‚Ä¢ Consider consulting with a Regulated Canadian Immigration Consultant (RCIC) for complex cases<br>
                ‚Ä¢ Processing times and draw scores are estimates based on historical data</p>
            </div>
        </section>
    </div>
    
    <!-- Footer -->
    <div class="footer">
        <p>Canada PR Pathways Calculator - Free & Open Source</p>
        <p>Made with ‚ù§Ô∏è for the Canadian immigration community</p>
        <p><a href="https://github.com/YOUR-USERNAME/canada-pr-calculator" target="_blank">View on GitHub</a></p>
        <p style="margin-top: 20px; font-size: 0.9em; opacity: 0.7;">
            This is an unofficial tool. Always verify with <a href="https://www.canada.ca/en/immigration-refugees-citizenship.html" target="_blank">official IRCC sources</a>
        </p>
    </div>
    
    <script>
        // Section switching
        function switchSection(section, element) {
            // Update nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            // Use the element parameter or find the tab by section name
            if (element) {
                element.classList.add('active');
            } else {
                // Fallback: find the correct tab
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    if (tab.textContent.toLowerCase().includes(section.toLowerCase())) {
                        tab.classList.add('active');
                    }
                });
            }
            
            // Update content sections
            document.querySelectorAll('.content-section').forEach(sec => {
                sec.classList.remove('active');
            });
            document.getElementById(section + 'Section').classList.add('active');
        }
        
        // FAQ toggle
        function toggleFAQ(element) {
            const faqItem = element.parentElement;
            faqItem.classList.toggle('open');
        }
        
        // Start calculator
        function startCalculator() {
            document.querySelector('.calculator-intro').style.display = 'none';
            document.getElementById('journeySelection').classList.add('active');
        }
        
        // Select journey
        function selectJourney(journey) {
            // Mark selected
            document.querySelectorAll('.journey-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            // After a brief delay, show the calculator form
            setTimeout(() => {
                document.getElementById('journeySelection').style.display = 'none';
                document.getElementById('calculatorForm').classList.add('active');
                // Here you would load the full calculator based on journey type
                loadCalculatorForJourney(journey);
            }, 300);
        }
        
        // Load calculator for specific journey
        function loadCalculatorForJourney(journey) {
            // Store journey type
            window.selectedJourney = journey;
            
            // Load the full calculator form
            document.getElementById('calculatorForm').innerHTML = getCalculatorHTML(journey);
            
            // Initialize form handlers
            initializeCalculatorHandlers();
            
            // Pre-fill based on journey type
            prefillByJourney(journey);
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Any initialization code
        });
        
        // Get calculator HTML based on journey
        function getCalculatorHTML(journey) {
            const journeyTitles = {
                'dreaming': 'Planning Your Journey to Canada',
                'studying': 'From Student to Permanent Resident',
                'working': 'Leveraging Your Canadian Experience'
            };
            
            return `
                <div style="background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.1);">
                    <!-- Progress Bar -->
                    <div style="background: #f7fafc; padding: 30px; border-bottom: 2px solid #e2e8f0;">
                        <h3 style="text-align: center; color: #2d3748; margin-bottom: 20px;">${journeyTitles[journey] || 'Calculate Your CRS Score'}</h3>
                        <div style="display: flex; justify-content: space-between; max-width: 600px; margin: 0 auto; position: relative;">
                            <div style="position: absolute; top: 20px; left: 0; right: 0; height: 2px; background: #e2e8f0; z-index: 1;"></div>
                            <div style="position: absolute; top: 20px; left: 0; height: 2px; background: #667eea; z-index: 2; transition: width 0.5s;" id="progressBar"></div>
                            
                            <div class="progress-step active" data-step="1" style="text-align: center; position: relative; z-index: 3;">
                                <div style="width: 40px; height: 40px; border-radius: 50%; background: #667eea; color: white; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px; font-weight: 600;">1</div>
                                <div style="font-size: 0.85em; color: #718096;">Personal</div>
                            </div>
                            <div class="progress-step" data-step="2" style="text-align: center; position: relative; z-index: 3;">
                                <div style="width: 40px; height: 40px; border-radius: 50%; background: #e2e8f0; color: #718096; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px; font-weight: 600;">2</div>
                                <div style="font-size: 0.85em; color: #718096;">Education</div>
                            </div>
                            <div class="progress-step" data-step="3" style="text-align: center; position: relative; z-index: 3;">
                                <div style="width: 40px; height: 40px; border-radius: 50%; background: #e2e8f0; color: #718096; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px; font-weight: 600;">3</div>
                                <div style="font-size: 0.85em; color: #718096;">Language</div>
                            </div>
                            <div class="progress-step" data-step="4" style="text-align: center; position: relative; z-index: 3;">
                                <div style="width: 40px; height: 40px; border-radius: 50%; background: #e2e8f0; color: #718096; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px; font-weight: 600;">4</div>
                                <div style="font-size: 0.85em; color: #718096;">Experience</div>
                            </div>
                            <div class="progress-step" data-step="5" style="text-align: center; position: relative; z-index: 3;">
                                <div style="width: 40px; height: 40px; border-radius: 50%; background: #e2e8f0; color: #718096; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px; font-weight: 600;">5</div>
                                <div style="font-size: 0.85em; color: #718096;">Results</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Form Steps -->
                    <div style="padding: 40px;">
                        <!-- Step 1: Personal Information -->
                        <div class="form-step active" data-step="1">
                            <h3 style="color: #2d3748; margin-bottom: 25px;">Personal Information</h3>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px;">
                                <div>
                                    <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500;">Date of Birth</label>
                                    <input type="date" id="calc_dob" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px;">
                                    <div style="font-size: 0.85em; color: #718096; margin-top: 5px;">Maximum points between ages 20-29</div>
                                </div>
                                
                                <div>
                                    <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500;">Marital Status</label>
                                    <select id="calc_marital" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px;">
                                        <option value="single">Single</option>
                                        <option value="married">Married/Common-law</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div id="spouseInfo" style="display: none; margin-top: 30px; padding: 25px; background: #f7fafc; border-radius: 12px;">
                                <h4 style="color: #2d3748; margin-bottom: 20px;">Spouse Information</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                                    <div>
                                        <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500;">Spouse's Education</label>
                                        <select id="calc_spouse_edu" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; background: white;">
                                            <option value="none">High school or less</option>
                                            <option value="diploma">Diploma/Certificate (1-2 years)</option>
                                            <option value="bachelor">Bachelor's degree</option>
                                            <option value="master">Master's or PhD</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500;">Spouse's English Level</label>
                                        <select id="calc_spouse_english" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; background: white;">
                                            <option value="0">No English test</option>
                                            <option value="4">CLB 4-5 (Basic)</option>
                                            <option value="6">CLB 6 (Moderate)</option>
                                            <option value="7">CLB 7-8 (Good)</option>
                                            <option value="9">CLB 9+ (Excellent)</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500;">Spouse's Canadian Work Experience</label>
                                        <select id="calc_spouse_work" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; background: white;">
                                            <option value="0">None</option>
                                            <option value="1">1 year</option>
                                            <option value="2">2 years</option>
                                            <option value="3">3+ years</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Step 2: Education -->
                        <div class="form-step" data-step="2" style="display: none;">
                            <h3 style="color: #2d3748; margin-bottom: 25px;">Education</h3>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px;">
                                <div>
                                    <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500;">Highest Education Level</label>
                                    <select id="calc_education" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px;">
                                        <option value="none">High school or less</option>
                                        <option value="diploma1">1-year diploma/certificate</option>
                                        <option value="diploma2">2-year diploma</option>
                                        <option value="bachelor">Bachelor's degree (3+ years)</option>
                                        <option value="two-or-more">Two or more degrees</option>
                                        <option value="master">Master's degree</option>
                                        <option value="phd">PhD</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500;">Canadian Education?</label>
                                    <select id="calc_canadian_edu" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px;">
                                        <option value="no">No Canadian education</option>
                                        <option value="1-2year">1-2 year Canadian diploma</option>
                                        <option value="3year">3+ year Canadian degree</option>
                                    </select>
                                    <div style="font-size: 0.85em; color: #718096; margin-top: 5px;">Canadian education gives bonus points!</div>
                                </div>
                            </div>
                            
                            <div class="info-box" style="background: #edf2f7; border-left: 4px solid #4299e1; padding: 20px; margin-top: 30px; border-radius: 8px;">
                                <h4 style="color: #2d3748; margin-bottom: 10px;">üìö Education Tips</h4>
                                <p style="color: #4a5568; line-height: 1.6;">
                                ‚Ä¢ Foreign degrees need an ECA (Educational Credential Assessment)<br>
                                ‚Ä¢ Canadian education gives 15-30 bonus points<br>
                                ‚Ä¢ Two degrees are better than one longer degree for points
                                </p>
                            </div>
                        </div>
                        
                        <!-- Step 3: Language -->
                        <div class="form-step" data-step="3" style="display: none;">
                            <h3 style="color: #2d3748; margin-bottom: 25px;">Language Skills</h3>
                            
                            <div style="margin-bottom: 30px;">
                                <h4 style="color: #4a5568; margin-bottom: 15px;">English Proficiency</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                                    <div>
                                        <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500;">English Level (CLB)</label>
                                        <select id="calc_english" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px;">
                                            <option value="0">No test / Below CLB 4</option>
                                            <option value="4">CLB 4</option>
                                            <option value="5">CLB 5</option>
                                            <option value="6">CLB 6</option>
                                            <option value="7">CLB 7 (IELTS 6.0 all)</option>
                                            <option value="8">CLB 8</option>
                                            <option value="9">CLB 9 (IELTS 7+)</option>
                                            <option value="10">CLB 10</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 30px;">
                                <h4 style="color: #4a5568; margin-bottom: 15px;">French Proficiency</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                                    <div>
                                        <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500;">French Level (NCLC)</label>
                                        <select id="calc_french" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px;">
                                            <option value="0">No French</option>
                                            <option value="4">NCLC 4</option>
                                            <option value="5">NCLC 5</option>
                                            <option value="6">NCLC 6</option>
                                            <option value="7">NCLC 7 (TEF B2)</option>
                                            <option value="8">NCLC 8</option>
                                            <option value="9">NCLC 9+</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="info-box" style="background: #f0fff4; border-left: 4px solid #48bb78; padding: 20px; margin-top: 30px; border-radius: 8px;">
                                <h4 style="color: #2d3748; margin-bottom: 10px;">üéØ Language Bonus</h4>
                                <p style="color: #4a5568; line-height: 1.6;">
                                <strong>French + English = 50 bonus points!</strong><br>
                                If you have NCLC 7+ in French AND CLB 5+ in English, you get a massive 50-point bonus. This is one of the best ways to boost your score!
                                </p>
                            </div>
                        </div>
                        
                        <!-- Step 4: Work Experience -->
                        <div class="form-step" data-step="4" style="display: none;">
                            <h3 style="color: #2d3748; margin-bottom: 25px;">Work Experience</h3>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px;">
                                <div>
                                    <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500;">Foreign Work Experience</label>
                                    <select id="calc_foreign_work" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px;">
                                        <option value="0">None</option>
                                        <option value="1">1 year</option>
                                        <option value="2">2 years</option>
                                        <option value="3">3+ years</option>
                                    </select>
                                    <div style="font-size: 0.85em; color: #718096; margin-top: 5px;">Work experience outside Canada</div>
                                </div>
                                
                                <div>
                                    <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500;">Canadian Work Experience</label>
                                    <select id="calc_canadian_work" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px;">
                                        <option value="0">None</option>
                                        <option value="1">1 year</option>
                                        <option value="2">2 years</option>
                                        <option value="3">3 years</option>
                                        <option value="4">4 years</option>
                                        <option value="5">5+ years</option>
                                    </select>
                                    <div style="font-size: 0.85em; color: #718096; margin-top: 5px;">Must be NOC TEER 0, 1, 2, or 3</div>
                                </div>
                            </div>
                            
                            <div style="margin-top: 30px;">
                                <h4 style="color: #4a5568; margin-bottom: 15px;">Additional Factors</h4>
                                <div style="display: grid; gap: 15px;">
                                    <label style="display: flex; align-items: center; padding: 15px; background: #f7fafc; border-radius: 8px; cursor: pointer;">
                                        <input type="checkbox" id="calc_sibling" style="margin-right: 10px; width: 20px; height: 20px;">
                                        <span style="color: #4a5568;">I have a sibling who is a Canadian citizen or PR (15 points)</span>
                                    </label>
                                    <label style="display: flex; align-items: center; padding: 15px; background: #f7fafc; border-radius: 8px; cursor: pointer;">
                                        <input type="checkbox" id="calc_pnp" style="margin-right: 10px; width: 20px; height: 20px;">
                                        <span style="color: #4a5568;">I have a Provincial Nomination (600 points!)</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Step 5: Results -->
                        <div class="form-step" data-step="5" style="display: none;">
                            <div id="calculationResults">
                                <!-- Results will be inserted here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Navigation -->
                    <div style="display: flex; justify-content: space-between; padding: 30px 40px; background: #f7fafc; border-top: 2px solid #e2e8f0;">
                        <button onclick="previousStep()" id="prevBtn" style="padding: 14px 30px; background: white; color: #4a5568; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1em; font-weight: 600; cursor: pointer; display: none;">‚Üê Previous</button>
                        <button onclick="nextStep()" id="nextBtn" style="padding: 14px 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 10px; font-size: 1em; font-weight: 600; cursor: pointer;">Next ‚Üí</button>
                        <button onclick="calculateScore()" id="calcBtn" style="padding: 14px 30px; background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); color: white; border: none; border-radius: 10px; font-size: 1em; font-weight: 600; cursor: pointer; display: none;">Calculate Score üéØ</button>
                        <button onclick="resetCalculator()" id="resetBtn" style="padding: 14px 30px; background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%); color: white; border: none; border-radius: 10px; font-size: 1em; font-weight: 600; cursor: pointer; display: none;">Start Over</button>
                    </div>
                </div>
            `;
        }
        
        // Initialize calculator handlers
        function initializeCalculatorHandlers() {
            // Marital status change handler
            const maritalSelect = document.getElementById('calc_marital');
            if (maritalSelect) {
                maritalSelect.addEventListener('change', function() {
                    const spouseInfo = document.getElementById('spouseInfo');
                    if (spouseInfo) {
                        spouseInfo.style.display = this.value === 'married' ? 'block' : 'none';
                    }
                });
            }
            
            // Set max date for DOB (must be at least 18)
            const dobInput = document.getElementById('calc_dob');
            if (dobInput) {
                const maxDate = new Date();
                maxDate.setFullYear(maxDate.getFullYear() - 18);
                dobInput.max = maxDate.toISOString().split('T')[0];
            }
        }
        
        // Pre-fill based on journey
        function prefillByJourney(journey) {
            if (journey === 'studying') {
                // Pre-select likely values for students
                const eduSelect = document.getElementById('calc_education');
                if (eduSelect) eduSelect.value = 'bachelor';
                
                const canEduSelect = document.getElementById('calc_canadian_edu');
                if (canEduSelect) canEduSelect.value = '3year';
                
                const englishSelect = document.getElementById('calc_english');
                if (englishSelect) englishSelect.value = '7';
                
            } else if (journey === 'working') {
                // Pre-select likely values for workers
                const workSelect = document.getElementById('calc_canadian_work');
                if (workSelect) workSelect.value = '1';
                
                const englishSelect = document.getElementById('calc_english');
                if (englishSelect) englishSelect.value = '8';
            }
        }
        
        // Step navigation
        let currentCalcStep = 1;
        
        function nextStep() {
            if (currentCalcStep < 5) {
                // Hide current step
                document.querySelector(`.form-step[data-step="${currentCalcStep}"]`).style.display = 'none';
                document.querySelector(`.progress-step[data-step="${currentCalcStep}"] div`).style.background = '#48bb78';
                
                // Show next step
                currentCalcStep++;
                document.querySelector(`.form-step[data-step="${currentCalcStep}"]`).style.display = 'block';
                document.querySelector(`.progress-step[data-step="${currentCalcStep}"] div`).style.background = '#667eea';
                document.querySelector(`.progress-step[data-step="${currentCalcStep}"] div`).style.color = 'white';
                
                // Update progress bar
                const progressBar = document.getElementById('progressBar');
                if (progressBar) {
                    progressBar.style.width = ((currentCalcStep - 1) / 4 * 100) + '%';
                }
                
                // Update buttons
                document.getElementById('prevBtn').style.display = 'inline-block';
                if (currentCalcStep === 4) {
                    document.getElementById('nextBtn').textContent = 'Calculate ‚Üí';
                }
                if (currentCalcStep === 5) {
                    document.getElementById('nextBtn').style.display = 'none';
                    document.getElementById('calcBtn').style.display = 'none';
                    document.getElementById('resetBtn').style.display = 'inline-block';
                    calculateScore();
                }
            } else if (currentCalcStep === 4) {
                // Move to results
                document.querySelector(`.form-step[data-step="${currentCalcStep}"]`).style.display = 'none';
                currentCalcStep = 5;
                document.querySelector(`.form-step[data-step="${currentCalcStep}"]`).style.display = 'block';
                document.querySelector(`.progress-step[data-step="${currentCalcStep}"] div`).style.background = '#667eea';
                document.querySelector(`.progress-step[data-step="${currentCalcStep}"] div`).style.color = 'white';
                document.getElementById('progressBar').style.width = '100%';
                document.getElementById('nextBtn').style.display = 'none';
                document.getElementById('calcBtn').style.display = 'none';
                document.getElementById('resetBtn').style.display = 'inline-block';
                calculateScore();
            }
        }
        
        function previousStep() {
            if (currentCalcStep > 1) {
                // Hide current step
                document.querySelector(`.form-step[data-step="${currentCalcStep}"]`).style.display = 'none';
                document.querySelector(`.progress-step[data-step="${currentCalcStep}"] div`).style.background = '#e2e8f0';
                document.querySelector(`.progress-step[data-step="${currentCalcStep}"] div`).style.color = '#718096';
                
                // Show previous step
                currentCalcStep--;
                document.querySelector(`.form-step[data-step="${currentCalcStep}"]`).style.display = 'block';
                
                // Update progress bar
                const progressBar = document.getElementById('progressBar');
                if (progressBar) {
                    progressBar.style.width = ((currentCalcStep - 1) / 4 * 100) + '%';
                }
                
                // Update buttons
                if (currentCalcStep === 1) {
                    document.getElementById('prevBtn').style.display = 'none';
                }
                document.getElementById('nextBtn').style.display = 'inline-block';
                document.getElementById('nextBtn').textContent = currentCalcStep === 4 ? 'Calculate ‚Üí' : 'Next ‚Üí';
                document.getElementById('resetBtn').style.display = 'none';
            }
        }
        
        function resetCalculator() {
            // Reset to step 1
            document.querySelector(`.form-step[data-step="${currentCalcStep}"]`).style.display = 'none';
            currentCalcStep = 1;
            document.querySelector(`.form-step[data-step="1"]`).style.display = 'block';
            
            // Reset progress indicators
            document.querySelectorAll('.progress-step div').forEach((step, index) => {
                if (index === 0) {
                    step.style.background = '#667eea';
                    step.style.color = 'white';
                } else {
                    step.style.background = '#e2e8f0';
                    step.style.color = '#718096';
                }
            });
            
            document.getElementById('progressBar').style.width = '0%';
            
            // Reset buttons
            document.getElementById('prevBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'inline-block';
            document.getElementById('nextBtn').textContent = 'Next ‚Üí';
            document.getElementById('resetBtn').style.display = 'none';
            
            // Clear form
            document.getElementById('calculatorForm').querySelectorAll('input, select').forEach(input => {
                if (input.type === 'checkbox') {
                    input.checked = false;
                } else {
                    input.value = '';
                }
            });
        }
        
        // Calculate CRS Score
        function calculateScore() {
            // Get all input values
            const dob = new Date(document.getElementById('calc_dob').value);
            const today = new Date();
            const age = Math.floor((today - dob) / (365.25 * 24 * 60 * 60 * 1000));
            
            const married = document.getElementById('calc_marital').value === 'married';
            const education = document.getElementById('calc_education').value;
            const canadianEdu = document.getElementById('calc_canadian_edu').value;
            const english = parseInt(document.getElementById('calc_english').value) || 0;
            const french = parseInt(document.getElementById('calc_french').value) || 0;
            const foreignWork = parseInt(document.getElementById('calc_foreign_work').value) || 0;
            const canadianWork = parseInt(document.getElementById('calc_canadian_work').value) || 0;
            const sibling = document.getElementById('calc_sibling').checked;
            const pnp = document.getElementById('calc_pnp').checked;
            
            // Spouse factors
            let spouseEdu = 'none', spouseEnglish = 0, spouseWork = 0;
            if (married) {
                spouseEdu = document.getElementById('calc_spouse_edu').value;
                spouseEnglish = parseInt(document.getElementById('calc_spouse_english').value) || 0;
                spouseWork = parseInt(document.getElementById('calc_spouse_work').value) || 0;
            }
            
            // Calculate scores for different scenarios
            const scenarios = [];
            
            // Current situation
            const currentScore = calculateCRSScore({
                age, married, education, canadianEdu, english, french,
                foreignWork, canadianWork, sibling, pnp,
                spouseEdu, spouseEnglish, spouseWork
            });
            
            scenarios.push({
                name: 'Your Current Score',
                score: currentScore.total,
                breakdown: currentScore,
                timeline: 'Today',
                status: 'current'
            });
            
            // With improved English
            if (english < 9) {
                const improvedEnglish = calculateCRSScore({
                    age, married, education, canadianEdu, 
                    english: 9, french,
                    foreignWork, canadianWork, sibling, pnp,
                    spouseEdu, spouseEnglish, spouseWork
                });
                scenarios.push({
                    name: 'With CLB 9 English',
                    score: improvedEnglish.total,
                    breakdown: improvedEnglish,
                    timeline: '3-6 months',
                    status: 'improvement'
                });
            }
            
            // With French
            if (french < 7) {
                const withFrench = calculateCRSScore({
                    age, married, education, canadianEdu, 
                    english, french: 7,
                    foreignWork, canadianWork, sibling, pnp,
                    spouseEdu, spouseEnglish, spouseWork
                });
                scenarios.push({
                    name: 'With French CLB 7',
                    score: withFrench.total,
                    breakdown: withFrench,
                    timeline: '12-18 months',
                    status: 'improvement'
                });
            }
            
            // With 1 year Canadian experience
            if (canadianWork === 0) {
                const withWork = calculateCRSScore({
                    age: age + 1, married, education, canadianEdu, 
                    english, french,
                    foreignWork, canadianWork: 1, sibling, pnp,
                    spouseEdu, spouseEnglish, spouseWork
                });
                scenarios.push({
                    name: 'With 1 Year Canadian Experience',
                    score: withWork.total,
                    breakdown: withWork,
                    timeline: '12 months',
                    status: 'improvement'
                });
            }
            
            // Display results
            displayCalculationResults(scenarios);
        }
        
        // CRS Score calculation logic
        function calculateCRSScore(params) {
            let score = {
                age: 0,
                education: 0,
                language: 0,
                experience: 0,
                skill: 0,
                additional: 0,
                spouse: 0,
                total: 0
            };
            
            // Age points
            const agePoints = getAgePoints(params.age, params.married);
            score.age = agePoints;
            
            // Education points
            const eduPoints = getEducationPoints(params.education, params.married);
            score.education = eduPoints;
            
            // Language points
            const langPoints = getLanguagePoints(params.english, params.french, params.married);
            score.language = langPoints;
            
            // Work experience points
            const workPoints = getWorkPoints(params.canadianWork, params.married);
            score.experience = workPoints;
            
            // Skill transferability (max 100)
            const skillPoints = getSkillTransferabilityPoints(params);
            score.skill = skillPoints;
            
            // Additional points
            let additional = 0;
            if (params.sibling) additional += 15;
            if (params.pnp) additional += 600;
            
            // Canadian education bonus
            if (params.canadianEdu === '1-2year') additional += 15;
            if (params.canadianEdu === '3year') additional += 30;
            
            // French bonus
            if (params.french >= 7 && params.english >= 5) {
                additional += 50; // Bilingual bonus
            } else if (params.french >= 7 && params.english < 5) {
                additional += 25; // French only bonus
            }
            
            score.additional = additional;
            
            // Spouse points
            if (params.married) {
                let spousePoints = 0;
                
                // Spouse education
                if (params.spouseEdu === 'diploma') spousePoints += 7;
                if (params.spouseEdu === 'bachelor') spousePoints += 8;
                if (params.spouseEdu === 'master') spousePoints += 10;
                
                // Spouse language
                if (params.spouseEnglish >= 9) spousePoints += 20;
                else if (params.spouseEnglish >= 7) spousePoints += 12;
                else if (params.spouseEnglish >= 6) spousePoints += 8;
                else if (params.spouseEnglish >= 4) spousePoints += 4;
                
                // Spouse work
                if (params.spouseWork >= 3) spousePoints += 10;
                else if (params.spouseWork === 2) spousePoints += 7;
                else if (params.spouseWork === 1) spousePoints += 5;
                
                score.spouse = spousePoints;
            }
            
            score.total = score.age + score.education + score.language + score.experience + 
                         score.skill + score.additional + score.spouse;
            
            return score;
        }
        
        // Helper functions for point calculations
        function getAgePoints(age, married) {
            const ageTable = {
                single: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,99,105,110,110,110,110,110,110,110,110,110,110,105,99,94,88,83,77,72,66,61,55,50,39,28,17,6,0],
                married: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,90,95,100,100,100,100,100,100,100,100,100,100,95,90,85,80,75,70,65,60,55,50,45,35,25,15,5,0]
            };
            const index = Math.min(age, 45);
            return married ? ageTable.married[index] : ageTable.single[index];
        }
        
        function getEducationPoints(education, married) {
            const eduTable = {
                none: { single: 0, married: 0 },
                diploma1: { single: 90, married: 84 },
                diploma2: { single: 98, married: 91 },
                bachelor: { single: 120, married: 112 },
                'two-or-more': { single: 128, married: 119 },
                master: { single: 135, married: 126 },
                phd: { single: 150, married: 140 }
            };
            return eduTable[education] ? (married ? eduTable[education].married : eduTable[education].single) : 0;
        }
        
        function getLanguagePoints(english, french, married) {
            // English points (first language)
            const engTable = {
                single: [0, 0, 0, 0, 6, 6, 9, 17, 23, 31, 34],
                married: [0, 0, 0, 0, 6, 6, 8, 16, 22, 29, 32]
            };
            
            let points = 0;
            const engIndex = Math.min(english, 10);
            points += (married ? engTable.married[engIndex] : engTable.single[engIndex]) * 4; // All 4 abilities
            
            // French points (second language)
            if (french >= 5) {
                points += Math.min(french - 4, 6) * 4; // 1 point for CLB 5-6, 3 for CLB 7-8, 6 for CLB 9+
            }
            
            return points;
        }
        
        function getWorkPoints(canadianWork, married) {
            const workTable = {
                single: [0, 40, 53, 64, 72, 80],
                married: [0, 35, 46, 56, 63, 70]
            };
            const index = Math.min(canadianWork, 5);
            return married ? workTable.married[index] : workTable.single[index];
        }
        
        function getSkillTransferabilityPoints(params) {
            let points = 0;
            
            // Education + Language
            if (params.english >= 9 && ['bachelor', 'two-or-more', 'master', 'phd'].includes(params.education)) {
                points += 50;
            } else if (params.english >= 7 && ['bachelor', 'two-or-more', 'master', 'phd'].includes(params.education)) {
                points += 25;
            }
            
            // Foreign work + Language
            if (params.foreignWork >= 3 && params.english >= 9) {
                points += 50;
            } else if (params.foreignWork >= 3 && params.english >= 7) {
                points += 25;
            } else if (params.foreignWork >= 1 && params.english >= 9) {
                points += 25;
            } else if (params.foreignWork >= 1 && params.english >= 7) {
                points += 13;
            }
            
            // Cap at 100
            return Math.min(points, 100);
        }
        
        // Display calculation results
        function displayCalculationResults(scenarios) {
            const resultsDiv = document.getElementById('calculationResults');
            
            // Sort scenarios by score
            scenarios.sort((a, b) => b.score - a.score);
            
            let html = '<h3 style="color: #2d3748; margin-bottom: 25px; text-align: center;">Your CRS Score Results</h3>';
            
            // Score cards
            html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">';
            
            scenarios.forEach((scenario, index) => {
                const scoreColor = scenario.score >= 500 ? '#48bb78' : 
                                 scenario.score >= 470 ? '#ed8936' : 
                                 scenario.score >= 440 ? '#f6ad55' : '#e53e3e';
                
                const statusText = scenario.score >= 500 ? 'Excellent!' : 
                                 scenario.score >= 470 ? 'Very Good' : 
                                 scenario.score >= 440 ? 'Competitive' : 'Needs Improvement';
                
                html += `
                    <div style="background: ${scenario.status === 'current' ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' : 'white'}; 
                               color: ${scenario.status === 'current' ? 'white' : '#2d3748'}; 
                               padding: 25px; border-radius: 15px; 
                               box-shadow: 0 5px 20px rgba(0,0,0,0.1); 
                               text-align: center;
                               border: 2px solid ${scenario.status === 'current' ? 'transparent' : '#e2e8f0'};">
                        <h4 style="margin-bottom: 10px; font-size: 1.1em;">${scenario.name}</h4>
                        <div style="font-size: 3em; font-weight: bold; margin: 15px 0; color: ${scenario.status === 'current' ? 'white' : scoreColor};">
                            ${scenario.score}
                        </div>
                        <div style="font-size: 0.9em; opacity: 0.9;">${statusText}</div>
                        <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid ${scenario.status === 'current' ? 'rgba(255,255,255,0.3)' : '#e2e8f0'};">
                            <small>Timeline: ${scenario.timeline}</small>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            
            // Detailed breakdown for current score
            const current = scenarios.find(s => s.status === 'current');
            if (current) {
                html += `
                    <div style="background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); margin-bottom: 30px;">
                        <h4 style="color: #2d3748; margin-bottom: 20px;">Score Breakdown</h4>
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr style="background: #f7fafc;">
                                <td style="padding: 12px; border: 1px solid #e2e8f0;"><strong>Category</strong></td>
                                <td style="padding: 12px; border: 1px solid #e2e8f0; text-align: right;"><strong>Points</strong></td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #e2e8f0;">Age</td>
                                <td style="padding: 12px; border: 1px solid #e2e8f0; text-align: right; color: #667eea; font-weight: 600;">${current.breakdown.age}</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #e2e8f0;">Education</td>
                                <td style="padding: 12px; border: 1px solid #e2e8f0; text-align: right; color: #667eea; font-weight: 600;">${current.breakdown.education}</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #e2e8f0;">Language Skills</td>
                                <td style="padding: 12px; border: 1px solid #e2e8f0; text-align: right; color: #667eea; font-weight: 600;">${current.breakdown.language}</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #e2e8f0;">Canadian Experience</td>
                                <td style="padding: 12px; border: 1px solid #e2e8f0; text-align: right; color: #667eea; font-weight: 600;">${current.breakdown.experience}</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #e2e8f0;">Skill Transferability</td>
                                <td style="padding: 12px; border: 1px solid #e2e8f0; text-align: right; color: #667eea; font-weight: 600;">${current.breakdown.skill}</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #e2e8f0;">Additional Factors</td>
                                <td style="padding: 12px; border: 1px solid #e2e8f0; text-align: right; color: #667eea; font-weight: 600;">${current.breakdown.additional}</td>
                            </tr>
                            ${current.breakdown.spouse > 0 ? `
                            <tr>
                                <td style="padding: 12px; border: 1px solid #e2e8f0;">Spouse Factors</td>
                                <td style="padding: 12px; border: 1px solid #e2e8f0; text-align: right; color: #667eea; font-weight: 600;">${current.breakdown.spouse}</td>
                            </tr>
                            ` : ''}
                            <tr style="background: #f7fafc;">
                                <td style="padding: 12px; border: 1px solid #e2e8f0;"><strong>Total CRS Score</strong></td>
                                <td style="padding: 12px; border: 1px solid #e2e8f0; text-align: right; font-size: 1.2em;"><strong>${current.breakdown.total}</strong></td>
                            </tr>
                        </table>
                    </div>
                `;
            }
            
            // Recommendations
            html += `
                <div class="info-box" style="background: #edf2f7; border-left: 4px solid #4299e1; padding: 20px; margin-bottom: 20px; border-radius: 8px;">
                    <h4 style="color: #2d3748; margin-bottom: 10px;">üí° Your Best Path Forward</h4>
                    <p style="color: #4a5568; line-height: 1.6;">
                        ${getRecommendations(scenarios)}
                    </p>
                </div>
            `;
            
            // Export and Advanced View buttons
            html += `
                <div style="text-align: center; margin-top: 30px; display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                    <button onclick="exportCalculation()" style="padding: 14px 30px; background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); color: white; border: none; border-radius: 10px; font-size: 1em; font-weight: 600; cursor: pointer;">
                        üì• Export Results
                    </button>
                    <button onclick="showAdvancedAnalysis()" style="padding: 14px 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 10px; font-size: 1em; font-weight: 600; cursor: pointer;">
                        üìä View All Scenario Combinations
                    </button>
                </div>
            `;
            
            resultsDiv.innerHTML = html;
        }
        
        // Get personalized recommendations
        function getRecommendations(scenarios) {
            const current = scenarios.find(s => s.status === 'current');
            const best = scenarios[0];
            
            let recommendations = [];
            
            if (current.score >= 500) {
                recommendations.push("Your score is excellent! You should receive an invitation in the next Express Entry draw.");
            } else if (current.score >= 470) {
                recommendations.push("Your score is competitive. Monitor upcoming draws closely - you're likely to receive an invitation soon.");
            } else if (current.score >= 440) {
                recommendations.push("Your score is moderate. Consider French language draws where the cutoff is typically much lower (350-430).");
            } else {
                recommendations.push("Focus on the improvements shown above to increase your score. French language proficiency offers the best return on investment.");
            }
            
            // Specific improvement suggestions
            if (best.score - current.score >= 50) {
                recommendations.push(`The improvements shown could increase your score by ${best.score - current.score} points!`);
            }
            
            const hasFrenchScenario = scenarios.find(s => s.name.includes('French'));
            if (hasFrenchScenario && hasFrenchScenario.score >= 430) {
                recommendations.push("Learning French to CLB 7 would qualify you for French-targeted draws with much lower requirements.");
            }
            
            return recommendations.join(" ");
        }
        
        // Export calculation results
        function exportCalculation() {
            const results = [];
            results.push("=== CANADA PR PATHWAYS CALCULATOR RESULTS ===");
            results.push(`Generated: ${new Date().toLocaleDateString()}`);
            results.push("");
            
            // Get form values for summary
            const age = Math.floor((new Date() - new Date(document.getElementById('calc_dob').value)) / (365.25 * 24 * 60 * 60 * 1000));
            
            results.push("YOUR PROFILE:");
            results.push(`Age: ${age} years`);
            results.push(`Education: ${document.getElementById('calc_education').selectedOptions[0].text}`);
            results.push(`English: CLB ${document.getElementById('calc_english').value}`);
            results.push(`French: ${document.getElementById('calc_french').value === '0' ? 'None' : 'NCLC ' + document.getElementById('calc_french').value}`);
            results.push(`Canadian Work Experience: ${document.getElementById('calc_canadian_work').selectedOptions[0].text}`);
            results.push(`Foreign Work Experience: ${document.getElementById('calc_foreign_work').selectedOptions[0].text}`);
            results.push("");
            
            // Get scenarios from display
            const scenarioCards = document.querySelectorAll('#calculationResults > div > div');
            results.push("CRS SCORES:");
            scenarioCards.forEach(card => {
                const title = card.querySelector('h4')?.textContent || '';
                const score = card.querySelector('div[style*="font-size: 3em"]')?.textContent || '';
                const timeline = card.querySelector('small')?.textContent || '';
                if (title && score) {
                    results.push(`${title}: ${score} points (${timeline})`);
                }
            });
            
            results.push("");
            results.push("NEXT STEPS:");
            results.push("1. Take official language tests (IELTS/CELPIP for English, TEF/TCF for French)");
            results.push("2. Get Educational Credential Assessment (ECA) for foreign degrees");
            results.push("3. Create Express Entry profile when ready");
            results.push("4. Monitor draw scores and requirements");
            
            results.push("");
            results.push("For more information, visit: https://pr-calc.samwu.dev");
            
            // Create and download file
            const blob = new Blob([results.join('\n')], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `CRS_Score_${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // Show Advanced Analysis View
        function showAdvancedAnalysis() {
            // Get current user data
            const dob = new Date(document.getElementById('calc_dob').value);
            const today = new Date();
            const age = Math.floor((today - dob) / (365.25 * 24 * 60 * 60 * 1000));
            const married = document.getElementById('calc_marital').value === 'married';
            const education = document.getElementById('calc_education').value;
            const canadianEdu = document.getElementById('calc_canadian_edu').value;
            const currentEnglish = parseInt(document.getElementById('calc_english').value) || 0;
            const currentFrench = parseInt(document.getElementById('calc_french').value) || 0;
            const foreignWork = parseInt(document.getElementById('calc_foreign_work').value) || 0;
            const currentCanadianWork = parseInt(document.getElementById('calc_canadian_work').value) || 0;
            const sibling = document.getElementById('calc_sibling').checked;
            const pnp = document.getElementById('calc_pnp').checked;
            
            // Spouse data
            let spouseEdu = 'none', spouseEnglish = 0, spouseWork = 0;
            if (married) {
                spouseEdu = document.getElementById('calc_spouse_edu').value;
                spouseEnglish = parseInt(document.getElementById('calc_spouse_english').value) || 0;
                spouseWork = parseInt(document.getElementById('calc_spouse_work').value) || 0;
            }
            
            // Generate all possible combinations
            const allScenarios = generateAllScenarios({
                age, married, education, canadianEdu, foreignWork, sibling, pnp,
                spouseEdu, spouseEnglish, currentEnglish, currentFrench, currentCanadianWork, spouseWork
            });
            
            // Create modal with advanced table
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.8);
                z-index: 10000;
                overflow-y: auto;
                padding: 20px;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                max-width: 1400px;
                margin: 0 auto;
                background: white;
                border-radius: 20px;
                padding: 30px;
                position: relative;
            `;
            
            // Create table HTML
            let tableHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 style="color: #2d3748; margin: 0;">Advanced Scenario Analysis - All Combinations</h2>
                    <button onclick="this.closest('div[style*=fixed]').remove()" style="background: #e53e3e; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600;">‚úï Close</button>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 10px; text-align: center;">
                        <div style="font-size: 0.9em; opacity: 0.9;">Highest Score</div>
                        <div style="font-size: 2em; font-weight: bold; margin: 5px 0;">${Math.max(...allScenarios.map(s => s.total))}</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); color: white; padding: 15px; border-radius: 10px; text-align: center;">
                        <div style="font-size: 0.9em; opacity: 0.9;">Current Score</div>
                        <div style="font-size: 2em; font-weight: bold; margin: 5px 0;">${allScenarios.find(s => s.isCurrent).total}</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%); color: white; padding: 15px; border-radius: 10px; text-align: center;">
                        <div style="font-size: 0.9em; opacity: 0.9;">French Impact</div>
                        <div style="font-size: 2em; font-weight: bold; margin: 5px 0;">+${calculateFrenchImpact(allScenarios)}</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #9f7aea 0%, #805ad5 100%); color: white; padding: 15px; border-radius: 10px; text-align: center;">
                        <div style="font-size: 0.9em; opacity: 0.9;">Total Scenarios</div>
                        <div style="font-size: 2em; font-weight: bold; margin: 5px 0;">${allScenarios.length}</div>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="margin-right: 10px; color: #4a5568; font-weight: 600;">Filter by minimum score:</label>
                    <select onchange="filterAdvancedTable(this.value)" style="padding: 8px; border: 2px solid #e2e8f0; border-radius: 8px;">
                        <option value="0">Show All</option>
                        <option value="450">450+ points</option>
                        <option value="480">480+ points</option>
                        <option value="500">500+ points</option>
                        <option value="520">520+ points</option>
                    </select>
                </div>
                
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 0.85em;">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%); color: white;">
                                <th rowspan="2" style="padding: 10px; border: 1px solid #4a5568; position: sticky; left: 0; background: #2d3748; z-index: 2;">#</th>
                                <th rowspan="2" style="padding: 10px; border: 1px solid #4a5568;">Timeline</th>
                                <th colspan="5" style="padding: 10px; border: 1px solid #4a5568; background: #2d3748;">Variables</th>
                                <th colspan="8" style="padding: 10px; border: 1px solid #4a5568; background: #2d3748;">Your Points</th>
                                ${married ? '<th colspan="3" style="padding: 10px; border: 1px solid #4a5568; background: #2d3748;">Spouse Points</th>' : ''}
                                <th rowspan="2" style="padding: 10px; border: 1px solid #4a5568; background: #48bb78;">Total CRS</th>
                            </tr>
                            <tr style="background: #4a5568; color: white;">
                                <th style="padding: 8px; border: 1px solid #4a5568;">Application</th>
                                <th style="padding: 8px; border: 1px solid #4a5568;">Your Fr</th>
                                <th style="padding: 8px; border: 1px solid #4a5568;">Your CA Work</th>
                                ${married ? '<th style="padding: 8px; border: 1px solid #4a5568;">Spouse Fr</th>' : ''}
                                ${married ? '<th style="padding: 8px; border: 1px solid #4a5568;">Spouse CA Work</th>' : ''}
                                <th style="padding: 8px; border: 1px solid #4a5568;">Age</th>
                                <th style="padding: 8px; border: 1px solid #4a5568;">Edu</th>
                                <th style="padding: 8px; border: 1px solid #4a5568;">Eng</th>
                                <th style="padding: 8px; border: 1px solid #4a5568;">Fr</th>
                                <th style="padding: 8px; border: 1px solid #4a5568;">CA Exp</th>
                                <th style="padding: 8px; border: 1px solid #4a5568;">Skill</th>
                                <th style="padding: 8px; border: 1px solid #4a5568;">CA Edu</th>
                                <th style="padding: 8px; border: 1px solid #4a5568;">Fr Bonus</th>
                                ${married ? '<th style="padding: 8px; border: 1px solid #4a5568;">Edu</th>' : ''}
                                ${married ? '<th style="padding: 8px; border: 1px solid #4a5568;">Lang</th>' : ''}
                                ${married ? '<th style="padding: 8px; border: 1px solid #4a5568;">Work</th>' : ''}
                            </tr>
                        </thead>
                        <tbody id="advancedTableBody">
            `;
            
            // Add rows
            allScenarios.forEach((scenario, index) => {
                const scoreClass = scenario.total >= 520 ? 'background: #c6f6d5;' : 
                                  scenario.total >= 480 ? 'background: #fed7aa;' : 
                                  'background: #e2e8f0;';
                
                const rowStyle = scenario.isCurrent ? 'background: #fef5e7; box-shadow: 0 2px 4px rgba(0,0,0,0.1);' : '';
                
                tableHTML += `
                    <tr class="advanced-row" data-score="${scenario.total}" style="${rowStyle}">
                        <td style="padding: 8px; border: 1px solid #e2e8f0; font-weight: bold; position: sticky; left: 0; background: white; ${rowStyle}">${index + 1}</td>
                        <td style="padding: 8px; border: 1px solid #e2e8f0;">${scenario.timeline}</td>
                        <td style="padding: 8px; border: 1px solid #e2e8f0;"><strong>${scenario.appType}</strong></td>
                        <td style="padding: 8px; border: 1px solid #e2e8f0; text-align: center;">${scenario.yourFrench ? '‚úì' : '‚úó'}</td>
                        <td style="padding: 8px; border: 1px solid #e2e8f0; text-align: center;">${scenario.yourCAWork}</td>
                        ${married ? `<td style="padding: 8px; border: 1px solid #e2e8f0; text-align: center;">${scenario.spouseFrench ? '‚úì' : '‚úó'}</td>` : ''}
                        ${married ? `<td style="padding: 8px; border: 1px solid #e2e8f0; text-align: center;">${scenario.spouseCAWork}</td>` : ''}
                        <td style="padding: 8px; border: 1px solid #e2e8f0; text-align: center;">${scenario.breakdown.age}</td>
                        <td style="padding: 8px; border: 1px solid #e2e8f0; text-align: center;">${scenario.breakdown.education}</td>
                        <td style="padding: 8px; border: 1px solid #e2e8f0; text-align: center;">${scenario.breakdown.english}</td>
                        <td style="padding: 8px; border: 1px solid #e2e8f0; text-align: center;">${scenario.breakdown.french}</td>
                        <td style="padding: 8px; border: 1px solid #e2e8f0; text-align: center;">${scenario.breakdown.canadianExp}</td>
                        <td style="padding: 8px; border: 1px solid #e2e8f0; text-align: center;">${scenario.breakdown.skill}</td>
                        <td style="padding: 8px; border: 1px solid #e2e8f0; text-align: center;">${scenario.breakdown.canadianEdu}</td>
                        <td style="padding: 8px; border: 1px solid #e2e8f0; text-align: center;">${scenario.breakdown.frenchBonus}</td>
                        ${married ? `<td style="padding: 8px; border: 1px solid #e2e8f0; text-align: center;">${scenario.breakdown.spouseEdu}</td>` : ''}
                        ${married ? `<td style="padding: 8px; border: 1px solid #e2e8f0; text-align: center;">${scenario.breakdown.spouseLang}</td>` : ''}
                        ${married ? `<td style="padding: 8px; border: 1px solid #e2e8f0; text-align: center;">${scenario.breakdown.spouseWork}</td>` : ''}
                        <td style="padding: 10px; border: 1px solid #e2e8f0; font-weight: bold; font-size: 1.1em; text-align: center; ${scoreClass}">${scenario.total}</td>
                    </tr>
                `;
            });
            
            tableHTML += `
                        </tbody>
                    </table>
                </div>
                
                <div style="margin-top: 25px; padding: 20px; background: #f7fafc; border-radius: 10px;">
                    <h4 style="color: #2d3748; margin-bottom: 10px;">üìà Key Insights from All Combinations</h4>
                    <ul style="color: #4a5568; line-height: 1.8;">
                        <li>Your highest possible score is <strong>${Math.max(...allScenarios.map(s => s.total))} points</strong></li>
                        <li>Learning French (CLB 7) adds an average of <strong>${calculateFrenchImpact(allScenarios)} points</strong></li>
                        <li>One year of Canadian work experience adds <strong>${married ? '35' : '40'} points</strong> directly</li>
                        <li>${allScenarios.filter(s => s.total >= 480).length} out of ${allScenarios.length} scenarios score above 480 (competitive threshold)</li>
                        <li>${allScenarios.filter(s => s.total >= 430).length} scenarios qualify for French-targeted draws (430+ with French)</li>
                    </ul>
                </div>
            `;
            
            modalContent.innerHTML = tableHTML;
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
        }
        
        // Generate all possible scenarios
        function generateAllScenarios(userData) {
            const scenarios = [];
            const timeframes = [
                { name: 'Current', years: 0, label: 'Today' },
                { name: '6 months', years: 0.5, label: 'Jun 2025' },
                { name: '1 year', years: 1, label: 'Dec 2025' },
                { name: '2 years', years: 2, label: 'Dec 2026' }
            ];
            
            // Variables to iterate
            const frenchOptions = [false, true]; // No French, CLB 7
            const canadianWorkOptions = [0, 1, 2]; // None, 1 year, 2 years
            const spouseWorkOptions = userData.married ? [0, 1, 2] : [0]; // Spouse work options
            
            timeframes.forEach(timeframe => {
                frenchOptions.forEach(hasFrench => {
                    canadianWorkOptions.forEach(caWork => {
                        // Skip invalid combinations (can't have 2 years work in 6 months)
                        if (caWork > timeframe.years + userData.currentCanadianWork) continue;
                        
                        if (userData.married) {
                            // Joint application scenarios
                            spouseWorkOptions.forEach(spWork => {
                                if (spWork > timeframe.years + userData.spouseWork) continue;
                                
                                const scenario = calculateDetailedScenario({
                                    ...userData,
                                    age: userData.age + Math.floor(timeframe.years),
                                    french: hasFrench ? 7 : userData.currentFrench,
                                    canadianWork: Math.min(caWork, 5),
                                    spouseWork: Math.min(spWork, 5),
                                    timeline: timeframe.label,
                                    appType: 'Joint',
                                    yourFrench: hasFrench,
                                    yourCAWork: caWork,
                                    spouseFrench: false, // Could add spouse French scenarios
                                    spouseCAWork: spWork,
                                    isCurrent: timeframe.years === 0 && !hasFrench && caWork === userData.currentCanadianWork && spWork === userData.spouseWork
                                });
                                scenarios.push(scenario);
                            });
                        } else {
                            // Solo application scenarios
                            const scenario = calculateDetailedScenario({
                                ...userData,
                                age: userData.age + Math.floor(timeframe.years),
                                french: hasFrench ? 7 : userData.currentFrench,
                                canadianWork: Math.min(caWork, 5),
                                timeline: timeframe.label,
                                appType: 'Solo',
                                yourFrench: hasFrench,
                                yourCAWork: caWork,
                                spouseFrench: false,
                                spouseCAWork: 0,
                                isCurrent: timeframe.years === 0 && !hasFrench && caWork === userData.currentCanadianWork
                            });
                            scenarios.push(scenario);
                        }
                    });
                });
            });
            
            // Sort by total score descending
            scenarios.sort((a, b) => b.total - a.total);
            
            return scenarios;
        }
        
        // Calculate detailed scenario breakdown
        function calculateDetailedScenario(params) {
            const score = calculateCRSScore({
                age: params.age,
                married: params.married,
                education: params.education,
                canadianEdu: params.canadianEdu,
                english: params.currentEnglish || 9,
                french: params.french,
                foreignWork: params.foreignWork,
                canadianWork: params.canadianWork,
                sibling: params.sibling,
                pnp: params.pnp,
                spouseEdu: params.spouseEdu,
                spouseEnglish: params.spouseEnglish,
                spouseWork: params.spouseWork
            });
            
            return {
                timeline: params.timeline,
                appType: params.appType,
                yourFrench: params.yourFrench,
                yourCAWork: params.yourCAWork,
                spouseFrench: params.spouseFrench,
                spouseCAWork: params.spouseCAWork,
                breakdown: {
                    age: score.age,
                    education: score.education,
                    english: params.currentEnglish >= 9 ? (params.married ? 116 : 124) : (params.married ? 64 : 68),
                    french: params.french >= 7 ? 12 : 0,
                    canadianExp: score.experience,
                    skill: score.skill,
                    canadianEdu: params.canadianEdu === '3year' ? 30 : params.canadianEdu === '1-2year' ? 15 : 0,
                    frenchBonus: params.french >= 7 && params.currentEnglish >= 5 ? 50 : 0,
                    spouseEdu: params.married ? (params.spouseEdu === 'master' ? 10 : params.spouseEdu === 'bachelor' ? 8 : 0) : 0,
                    spouseLang: params.married ? (params.spouseEnglish >= 7 ? 12 : params.spouseEnglish >= 5 ? 6 : 0) : 0,
                    spouseWork: params.married ? (params.spouseWork >= 2 ? 7 : params.spouseWork === 1 ? 5 : 0) : 0
                },
                total: score.total,
                isCurrent: params.isCurrent
            };
        }
        
        // Calculate French impact
        function calculateFrenchImpact(scenarios) {
            const withFrench = scenarios.filter(s => s.yourFrench);
            const withoutFrench = scenarios.filter(s => !s.yourFrench);
            
            if (withFrench.length === 0 || withoutFrench.length === 0) return 0;
            
            const avgWith = withFrench.reduce((sum, s) => sum + s.total, 0) / withFrench.length;
            const avgWithout = withoutFrench.reduce((sum, s) => sum + s.total, 0) / withoutFrench.length;
            
            return Math.round(avgWith - avgWithout);
        }
        
        // Filter advanced table
        window.filterAdvancedTable = function(minScore) {
            const rows = document.querySelectorAll('.advanced-row');
            rows.forEach(row => {
                const score = parseInt(row.dataset.score);
                row.style.display = score >= minScore ? '' : 'none';
            });
        }
    </script>
</body>
</html>